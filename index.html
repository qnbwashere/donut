<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Game Launcher</title>
<style>
body{
  background:#111;
  color:white;
  font-family:sans-serif;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
}
button{
  padding:20px 40px;
  font-size:20px;
  cursor:pointer;
}
</style>
</head>
<body>

<button id="launch">Launch Game</button>

<script>
document.getElementById("launch").onclick = function(){

const popup = window.open("", "_blank", "width=1200,height=800,resizable=yes");

popup.document.write(`
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Game Portal</title>
<style>
body{
  margin:0;
  background:#1b1b1b;
  color:white;
  font-family:sans-serif;
  display:flex;
  height:100vh;
  overflow:hidden;
}

#layout{
  display:flex;
  width:100%;
}

#game-box{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  background:black;
  position:relative;
  overflow:hidden;
}

#game-box.fullscreen{
  position:fixed;
  inset:0;
  z-index:9999;
}

iframe{
  transform-origin:top left;
}

#panel{
  width:300px;
  background:#222;
  padding:15px;
  box-sizing:border-box;
  overflow-y:auto;
}

h2{
  margin-top:0;
}

label{
  display:block;
  margin-top:10px;
}

button{
  margin-top:10px;
  width:100%;
}

.low-motion *{
  animation:none !important;
  transition:none !important;
}

#fps{
  margin-top:10px;
  font-weight:bold;
}
</style>
</head>
<body>

<div id="layout">
  <div id="game-box">
    <iframe id="game" width="640" height="480"
      src="https://example.com">
    </iframe>
  </div>

  <div id="panel">
    <h2>Settings</h2>

    <label>Resolution Scale
      <input type="range" id="scale" min="0.5" max="1" step="0.05" value="1">
    </label>

    <label>FPS Cap
      <select id="fpsCap">
        <option value="0">Unlimited</option>
        <option value="30">30</option>
        <option value="60" selected>60</option>
      </select>
    </label>

    <button id="fullscreen">Toggle Fullscreen</button>
    <button id="toggleAnim">Toggle Animations</button>

    <h3>Presets</h3>
    <button id="perf">Performance</button>
    <button id="balanced">Balanced</button>
    <button id="quality">Quality</button>

    <div id="fps">FPS: 0</div>
  </div>
</div>

<script>

const game = document.getElementById("game");
const box = document.getElementById("game-box");

let baseScale = 1;
let fpsCap = 60;
let lastFrame = 0;
let frames = 0;
let lastUpdate = performance.now();

function applyScale(){
  game.style.transform = "scale("+baseScale+")";
}

document.getElementById("scale").oninput = function(){
  baseScale = parseFloat(this.value);
  applyScale();
};

document.getElementById("fpsCap").onchange = function(){
  fpsCap = parseInt(this.value);
};

document.getElementById("fullscreen").onclick = function(){
  box.classList.toggle("fullscreen");
  adjustFullscreenScale();
};

function adjustFullscreenScale(){
  if(!box.classList.contains("fullscreen")) return;

  const fit = Math.min(
    window.innerWidth/640,
    window.innerHeight/480
  );

  const finalScale = fit * (1/baseScale);
  game.style.transform = "scale("+finalScale+")";
}

window.onresize = adjustFullscreenScale;

document.getElementById("toggleAnim").onclick = function(){
  document.body.classList.toggle("low-motion");
};

document.getElementById("perf").onclick = function(){
  baseScale = 0.7;
  fpsCap = 60;
  document.body.classList.add("low-motion");
  document.getElementById("scale").value = 0.7;
  document.getElementById("fpsCap").value = 60;
  applyScale();
};

document.getElementById("balanced").onclick = function(){
  baseScale = 0.85;
  fpsCap = 60;
  document.body.classList.remove("low-motion");
  document.getElementById("scale").value = 0.85;
  document.getElementById("fpsCap").value = 60;
  applyScale();
};

document.getElementById("quality").onclick = function(){
  baseScale = 1;
  fpsCap = 0;
  document.body.classList.remove("low-motion");
  document.getElementById("scale").value = 1;
  document.getElementById("fpsCap").value = 0;
  applyScale();
};

function loop(now){

  if(!fpsCap || now-lastFrame >= 1000/fpsCap){
    lastFrame = now;
    frames++;
  }

  if(now-lastUpdate >= 1000){
    document.getElementById("fps").textContent = "FPS: " + frames;
    frames = 0;
    lastUpdate = now;
  }

  requestAnimationFrame(loop);
}

applyScale();
requestAnimationFrame(loop);

</script>

</body>
</html>
`);

document.body.innerHTML = "";

};
</script>

</body>
</html>
